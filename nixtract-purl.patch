From c67ce4aaf3a1e58987d41c09187406711636d94c Mon Sep 17 00:00:00 2001
From: h0nIg <h0nIg@users.noreply.github.com>
Date: Mon, 30 Jun 2025 09:53:34 +0200
Subject: [PATCH 1/3] implement CPE and pURL reference

---
 src/nix/describe_derivation.nix | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/nix/describe_derivation.nix b/src/nix/describe_derivation.nix
index 96ab159..0bec422 100644
--- a/src/nix/describe_derivation.nix
+++ b/src/nix/describe_derivation.nix
@@ -49,6 +49,8 @@ in
       version = (builtins.tryEval (targetValue.version or "")).value;
       broken = (builtins.tryEval (targetValue.meta.broken or false)).value;
       homepage = (builtins.tryEval (targetValue.meta.homepage or "")).value;
+      cpe = (builtins.tryEval (targetValue.meta.identifiers.v1.cpe or [])).value;
+      purl = (builtins.tryEval (targetValue.meta.identifiers.v1.purl or "")).value;
       licenses = (builtins.tryEval (
         if builtins.isAttrs (targetValue.meta.license or null)
         # In case the license attribute is not a list, we produce a singleton list to be consistent

From 7140acb81586107145fb2af75644feb2f9e5fe77 Mon Sep 17 00:00:00 2001
From: h0nIg <h0nIg@users.noreply.github.com>
Date: Tue, 1 Jul 2025 11:34:19 +0200
Subject: [PATCH 3/3] purl is null by default, so we keep the default

---
 src/nix/describe_derivation.nix | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/nix/describe_derivation.nix b/src/nix/describe_derivation.nix
index 0bec422..491e475 100644
--- a/src/nix/describe_derivation.nix
+++ b/src/nix/describe_derivation.nix
@@ -50,7 +50,7 @@ in
       broken = (builtins.tryEval (targetValue.meta.broken or false)).value;
       homepage = (builtins.tryEval (targetValue.meta.homepage or "")).value;
       cpe = (builtins.tryEval (targetValue.meta.identifiers.v1.cpe or [])).value;
-      purl = (builtins.tryEval (targetValue.meta.identifiers.v1.purl or "")).value;
+      purl = (builtins.tryEval (targetValue.meta.identifiers.v1.purl or null)).value;
       licenses = (builtins.tryEval (
         if builtins.isAttrs (targetValue.meta.license or null)
         # In case the license attribute is not a list, we produce a singleton list to be consistent
